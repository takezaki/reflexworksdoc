<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>VTECH - Virtual Technology's Portal Site</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          <meta name="author" content="N.Terada" />
                                                        
<link rel="shortcut icon" href="./images/favicon.ico"/>
                    </head>
  <body class="composite">
    <div id="banner">
                    <span id="bannerLeft">
    
            Virtual Technology
    
            </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
              <div class="xright">      
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                   <h5>Links</h5>
            <ul>
              
    <li class="none">
                    <a href="index.html">Home</a>
          </li>
              
    <li class="none">
                    <a href="blog.html">blog</a>
          </li>
          </ul>
              <h5>Reflex</h5>
            <ul>
              
    <li class="none">
                    <a href="reflexoverview.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="reflexcore.html">Reflex Core Module</a>
          </li>
              
    <li class="none">
                    <a href="reflexcoresample.html">Reflex Core Sample</a>
          </li>
              
    <li class="none">
                    <a href="reflexgaesample.html">Reflex JDO Sample</a>
          </li>
              
    <li class="none">
                    <a href="reflexgaelib.html">Reflex GAE</a>
          </li>
              
    <li class="none">
                    <a href="reflexsoapsample.html">Reflex SOAP Sample</a>
          </li>
              
    <li class="none">
                    <a href="reflexatomsample.html">Reflex ATOM Sample</a>
          </li>
              
    <li class="none">
                    <a href="reflexjson.html">Reflex JSON</a>
          </li>
              
    <li class="none">
                    <a href="reflexjsonsample.html">Reflex JSON Sample</a>
          </li>
              
    <li class="none">
                    <a href="reflexentityeditor.html">Reflex Entity Editor</a>
          </li>
          </ul>
              <h5>Reflex iText</h5>
            <ul>
              
    <li class="none">
                    <a href="reflexitextoverview.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="reflexitext_contents.html">Contents</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_basic.html">Basic1</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_basic2.html">Basic2</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_basic3.html">Basic3</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_function.html">Function1</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_function2.html">Function2</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_function3.html">Function3</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_function4.html">Function4</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_function5.html">Function5</a>
          </li>
              
    <li class="none">
                    <a href="reflexitextsample_security.html">Security</a>
          </li>
              
    <li class="none">
                    <a href="reflexitext_performance.html">Performance</a>
          </li>
          </ul>
              <h5>Tagging Service</h5>
            <ul>
              
    <li class="none">
                    <a href="taggingservice.html">Overview,CRUD</a>
          </li>
              
    <li class="none">
                    <a href="taggingservice_2.html">ATOM Search</a>
          </li>
              
    <li class="none">
                    <a href="taggingservice_3.html">OpenID,ACL</a>
          </li>
              
    <li class="none">
                    <a href="taggingservice_4.html">WebHook,SSS</a>
          </li>
              
    <li class="none">
                    <a href="taggingservice_5.html">Examples</a>
          </li>
              
    <li class="none">
                    <a href="virtualcart.html">VirtualCart</a>
          </li>
          </ul>
              <h5>Reflex BDB</h5>
            <ul>
              
    <li class="none">
                    <a href="reflexbdb.html">Overview</a>
          </li>
          </ul>
              <h5>Service</h5>
            <ul>
              
    <li class="none">
                    <a href="scalablepdf.html">Scalable PDF</a>
          </li>
              
    <li class="none">
                    <a href="edgecomputing.html">Edge Computing</a>
          </li>
              
    <li class="none">
                    <a href="android.html">Android</a>
          </li>
              
    <li class="none">
                    <a href="support.html">Product Support</a>
          </li>
              
    <li class="none">
                    <a href="consulting.html">Consulting</a>
          </li>
          </ul>
              <h5>Tips</h5>
            <ul>
              
    <li class="none">
                    <a href="googlejson.html">Google Calendar JSON</a>
          </li>
              
    <li class="none">
                    <a href="javaapplet.html">Java Applet</a>
          </li>
              
    <li class="none">
                    <a href="javawebstart.html">Java Web Start</a>
          </li>
              
    <li class="none">
                    <a href="jetty.html">Jetty</a>
          </li>
              
    <li class="none">
                    <a href="pmsdemo.html">PMS Demo</a>
          </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
  
  
    
            <div id="lastPublished">
        最終更新: 2012-05-15 15:16
              </div>
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Reflex BDB チュートリアル (2/10)</h2>
<div class="section"><h3>Blankプロジェクト simple版(blanksimply)のコード説明</h3>
<div class="section"><h4>エンティティ</h4>
<ul><li>エンティティとはデータの実体のことでデータの受け渡しのために使うオブジェクトのことをいいます。 エンティティクラスを元に生成したオブジェクトは、BDBにそのまま格納することができます。 また、オブジェクトからXMLやJSONに変換することができます。その際、O/Rマッピングなどの変換は必要ありません。<ul><li>詳しい変換ルールについては、Reflex Core Module、および、Reflex JSONを参照してください。</li>
</ul>
</li>
<li>エンティティクラスに実装するプロパティが項目に対応します。<ul><li>プロパティに@Indexアノテーションを付与することで検索対象とすることができます。</li>
<li>プロパティに@Encryptアノテーションを付与することで暗号化対象とすることができます。</li>
<li>@Indexアノテーションと@Encryptアノテーションはどちらかを付けることができますが両方は付けることはできません。</li>
</ul>
</li>
</ul>
<div class="section"><h5>Feed.java</h5>
<div class="source"><pre>package jp.reflexworks.blank.simply.model;

import java.io.Serializable;

import jp.reflexworks.atom.feed.FeedBase;

public class Feed extends FeedBase implements Serializable {

        private static final long serialVersionUID = 1L;

        public String _$xmlns = &quot;http://www.w3.org/2005/Atom&quot;;

        // ---- 独自名前空間定義 ----
        public String _$xmlns$blank = &quot;http://reflexworks.jp/blank/1.0&quot;;

        // getter、setterを定義してください。
        public String get_$xmlns() {
                return _$xmlns;
        }
        public void set_$xmlns(String _$xmlns) {
                this._$xmlns = _$xmlns;
        }
        public String get_$xmlns$blank() {
                return _$xmlns$blank;
        }
        public void set_$xmlns$blank(String _$xmlns$blank) {
                this._$xmlns$blank = _$xmlns$blank;
        }
}</pre>
</div>
<ul><li>ユーザ定義の名前空間を決め、(_$xmlns${ユーザ定義名前空間名})を定義し、値を設定してください。 ただし修飾子にはfinalを使わないでください。</li>
<li>各項目にgetter、setterを定義してください。</li>
</ul>
</div>
<div class="section"><h5>Entry.java</h5>
<div class="source"><pre>package jp.reflexworks.blank.simply.model;

import java.io.Serializable;

import jp.reflexworks.atom.entry.EntryBase;
import jp.reflexworks.taggingservice.annotation.Index;

public class Entry extends EntryBase implements Serializable {

        private static final long serialVersionUID = 1L;

        // 独自名前空間があり、デフォルトの名前空間項目が親クラスに定義されている場合、
        // デフォルト名前空間項目を子クラスにも定義する。

        public String _$xmlns = &quot;http://www.w3.org/2005/Atom&quot;;

        // ---- 独自名前空間定義 ----
        public String _$xmlns$blank = &quot;http://reflexworks.jp/blank/1.0&quot;;

        // ---- 独自名前空間項目　----
    public Member member;

    /** 作成者 */
    @Index
    public String blank$creator;
    /** 新規作成年月日 */
    @Index
    public String blank$created;
    /** 更新者 */
    @Index
    public String blank$updater;
    /** 更新年月日 */
    @Index
    public String blank$updated;

    /** 論理削除フラグ */
    @Index
    public String blank$deleted;

        // getter、setterを定義してください。
        public String get_$xmlns() {
                return _$xmlns;
        }
        public void set_$xmlns(String _$xmlns) {
                this._$xmlns = _$xmlns;
        }
        public String get_$xmlns$blank() {
                return _$xmlns$blank;
        }
        public void set_$xmlns$blank(String _$xmlns$blank) {
                this._$xmlns$blank = _$xmlns$blank;
        }
        public Member getMember() {
                return member;
        }
        public void setMember(Member member) {
                this.member = member;
        }
        public String getBlank$creator() {
                return blank$creator;
        }
        public void setBlank$creator(String blank$creator) {
                this.blank$creator = blank$creator;
        }
        public String getBlank$created() {
                return blank$created;
        }
        public void setBlank$created(String blank$created) {
                this.blank$created = blank$created;
        }
        public String getBlank$updater() {
                return blank$updater;
        }
        public void setBlank$updater(String blank$updater) {
                this.blank$updater = blank$updater;
        }
        public String getBlank$updated() {
                return blank$updated;
        }
        public void setBlank$updated(String blank$updated) {
                this.blank$updated = blank$updated;
        }
        public String getBlank$deleted() {
                return blank$deleted;
        }
        public void setBlank$deleted(String blank$deleted) {
                this.blank$deleted = blank$deleted;
        }
}</pre>
</div>
<ul><li>エンティティクラスは、jp.reflexworks.atom.entry.EntryBaseを継承し、Serializableを実装します。<ul><li>EntryBaseを継承することで、AtomのEntryとすることができます。(Atomのエンティティクラスはtaggingservicecore.jarにあります）</li>
<li>AtomのEntryが出発点となり必要に応じてユーザ定義の子要素を追加していく形となります。<ul><li>ユーザ定義の子要素を追加した場合はユーザ定義の名前空間となります。</li>
</ul>
</li>
<li>BDBに対してシリアライズしたデータの登録ができるようにするため、Serializableを実装する必要があります。</li>
</ul>
</li>
<li>serialVersionUIDを定義してください。<ul><li>値にデフォルト値を指定することを推奨します。</li>
<li>この値が変更された場合、項目の変更が行われなくてもBDBではバージョン不一致とみなされるためエラーとなります。</li>
</ul>
</li>
<li>ユーザ定義の名前空間を決め、(_$xmlns${ユーザ定義名前空間名})を定義し、値を設定してください。 ただし修飾子にはfinalを使わないでください。</li>
<li>各項目ごとにプロパティを記述してください。プロパティ名は、{ユーザ定義名前空間}${項目名} の形で記述します。 ただし、子要素を定義する場合（上記のmemberが該当）は、{ユーザ定義名前空間}を省いた形で記述します。 子要素は別クラスとして定義します。</li>
<li>プロパティのアクセス修飾子をpublicにしてください。publicにすることでxmlやjsonへの変換対象とみなされます。</li>
<li>各プロパティにアクセサ(getter、setter)を実装してください。アクセサを実装しないと正しく動作しません。</li>
</ul>
</div>
<div class="section"><h5>Member.java</h5>
<div class="source"><pre>package jp.reflexworks.blank.simply.model;

import java.io.Serializable;

import jp.reflexworks.taggingservice.annotation.Index;
import jp.reflexworks.taggingservice.annotation.Encrypt;

public class Member implements Serializable {

        private static final long serialVersionUID = 1L;
        
    /** 会員コード */
        public String blank$member_code;
    /** 会員名 */
    @Index
        public String blank$member_name;
    /** 住所 */
    @Encrypt(&quot;addrpass&quot;)
        public String blank$address;
    /** 電話番号 */
    @Index
        public String blank$phonenumber;
    /** 性別 */
    public String blank$gender;
    /** 生年月日 */
    public String blank$birthdate;
    /** プロフィール */
        public String blank$profile;

        // getter、setterを定義してください。
        public String getBlank$member_code() {
                return blank$member_code;
        }
        public void setBlank$member_code(String blank$member_code) {
                this.blank$member_code = blank$member_code;
        }
        public String getBlank$member_name() {
                return blank$member_name;
        }
        public void setBlank$member_name(String blank$member_name) {
                this.blank$member_name = blank$member_name;
        }
        public String getBlank$address() {
                return blank$address;
        }
        public void setBlank$address(String blank$address) {
                this.blank$address = blank$address;
        }
        public String getBlank$phonenumber() {
                return blank$phonenumber;
        }
        public void setBlank$phonenumber(String blank$phonenumber) {
                this.blank$phonenumber = blank$phonenumber;
        }
        public String getBlank$gender() {
                return blank$gender;
        }
        public void setBlank$gender(String blank$gender) {
                this.blank$gender = blank$gender;
        }
        public String getBlank$birthdate() {
                return blank$birthdate;
        }
        public void setBlank$birthdate(String blank$birthdate) {
                this.blank$birthdate = blank$birthdate;
        }
        public String getBlank$profile() {
                return blank$profile;
        }
        public void setBlank$profile(String blank$profile) {
                this.blank$profile = blank$profile;
        }
        
}</pre>
</div>
<ul><li>Memberはユーザ定義の子要素なのでAtomのEntryBaseを継承する必要はありません。</li>
<li>BDBに対してシリアライズしたデータの登録ができるようにするため、Serializableを実装する必要があります。</li>
<li>会員名と電話番号を検索対象とするために@Indexアノテーションを付与します。</li>
<li>住所を暗号化対象とするために@Encryptアノテーションを付与します。</li>
</ul>
</div>
</div>
<div class="section"><h4>プロバイダサービス</h4>
<ul><li>ReflexServletを継承することでプロバイダサービスを作成できます。</li>
<li>プロバイダサービスでは、ReflexContextオブジェクトを利用することで、サーブレットから直接BDBへのアクセスが行えます。 これにより、データチェックサービス等、サーバ側の機能として必要なビジネスロジックの実装が可能になります。</li>
<li>プロバイダサービスは、TaggingserviceFilter(Reflex共通処理実行フィルタ)を使用することができます。 TaggingserviceFilterでは、以下のような共通処理を行った後、サーブレットに処理を移譲します。<ul><li>リクエスト/レスポンスログ出力</li>
<li>認証処理 (認証チェックサービス)</li>
<li>ノード判定</li>
<li>メソッド判定</li>
<li>リクエスト/レスポンスオブジェクト変換</li>
<li>リクエストのPOSTデータ取り込み<ul><li>(オブジェクトへの変換はTaggingserviceRequest#getObjectメソッド実行時に行います。)</li>
</ul>
</li>
<li>SSID設定</li>
<li>エラーレスポンスデータ出力</li>
</ul>
</li>
<li>以下はTaggingserviceRequestが持っている機能の一例です。 （※ RequestオブジェクトをTaggingserviceRequestオブジェクトにキャストして使う必要があります。）<ul><li>TaggingserviceRequest#getContext()<ul><li>URLパラメータをパースしたContextクラスの取得</li>
</ul>
</li>
<li>TaggingserviceRequest#getObject()<ul><li>POSTデータをオブジェクト変換して取得</li>
</ul>
</li>
</ul>
</li>
<li>ReflexContextオブジェクトを使うことでBDBの操作が行えます。 ReflexContextオブジェクトはパラメータにリクエストオブジェクトとレスポンスオブジェクトを与えることで生成できます。 ReflexContextで使えるメソッドの詳細についてはJavaDocを参照してください。<div class="source"><pre>    ReflexContext reflexContext = new ReflexContext(req, resp);
    reflexContext.getEntry(url);
    ・・・</pre>
</div>
</li>
</ul>
<div class="section"><h5>BlankSimplyProvider.java</h5>
<div class="source"><pre>package jp.reflexworks.blank.simply.service;

import java.io.IOException;
import java.util.logging.Logger;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import jp.reflexworks.atom.entry.EntryBase;
import jp.reflexworks.atom.feed.FeedBase;
import jp.reflexworks.servlet.ReflexServlet;
import jp.reflexworks.taggingservice.servlet.TaggingserviceRequest;
import jp.reflexworks.taggingservice.util.RequestType;
import jp.reflexworks.taggingservice.util.ReflexContext;
import jp.reflexworks.taggingservice.wrapper.TaggingserviceEnv;

@SuppressWarnings(&quot;serial&quot;)
public class BlankSimplyProvider extends ReflexServlet {

        private Logger logger = Logger.getLogger(this.getClass().getName());

        public void doGet(HttpServletRequest req, HttpServletResponse resp)
                        throws IOException {

                RequestType param = ((TaggingserviceRequest)req).getRequestType();
                Object retObj = null;

                try {
                        // ReflexContextを生成
                        ReflexContext reflexContext = new ReflexContext(req, resp);
                        
                        String requestUri = getRequestUri(req);

                        if (param.isEntry() ||
                                        req.getPathInfo().indexOf(&quot;.&quot;) &gt; -1) {
                                // Entry検索
                                EntryBase entry = reflexContext.getEntry(requestUri);
                                retObj = entry;

                        } else if (param.isAllocids()) {
                                // 採番
                                EntryBase entry = reflexContext.getAllocateIds(req.getPathInfo(), 
                                                intValue(param.allocids));
                                retObj = entry;

                        } else if (param.isCount()) {
                                // count
                                EntryBase entry = reflexContext.getCount(requestUri);
                                retObj = entry;

                        } else {
                                // Feed検索
                                FeedBase feed = reflexContext.getFeed(requestUri);
                                retObj = feed;
                        }
                        
                        doResponse(resp, retObj, param.useJson, 
                                        TaggingserviceEnv.getDefault().getResourceMapper(), param.callback);

                } catch (Throwable e) {
                        // Filterに例外を返す
                        IOException ie = new IOException();
                        ie.initCause(e);
                        throw ie;
                }
        }

        public void doPost(HttpServletRequest req, HttpServletResponse resp)
                        throws IOException {

                RequestType param = ((TaggingserviceRequest)req).getRequestType();
                try {
                        ReflexContext reflexContext = new ReflexContext(req, resp);
                        
                        String uri = req.getPathInfo();
                        Object obj = ((TaggingserviceRequest)req).getObject();  // POSTデータの取得
                        
                        EntryBase retObj = null;
                        if (obj instanceof EntryBase) {
                                if (uri != null &amp;&amp; !&quot;&quot;.equals(uri)) {
                                        // Entry登録(自動採番)
                                        retObj = reflexContext.postEntry((EntryBase)obj, uri);
                                } else {
                                        // Entry登録
                                        retObj = reflexContext.postEntry((EntryBase)obj);
                                }
                        } else if (obj instanceof FeedBase) {
                                if (uri != null &amp;&amp; !&quot;&quot;.equals(uri)) {
                                        // Feed登録(自動採番)
                                        retObj = reflexContext.postFeed((FeedBase)obj, uri);
                                } else {
                                        // Feed登録
                                        retObj = reflexContext.postFeed((FeedBase)obj);
                                }
                        }
                        
                        doResponse(resp, retObj, param.useJson, 
                                        TaggingserviceEnv.getDefault().getResourceMapper(), param.callback);

                } catch (Throwable e) {
                        // Filterに例外を返す
                        IOException ie = new IOException();
                        ie.initCause(e);
                        throw ie;
                }
        }

        public void doPut(HttpServletRequest req, HttpServletResponse resp)
                        throws IOException {

                RequestType param = ((TaggingserviceRequest)req).getRequestType();
                try {
                        ReflexContext reflexContext = new ReflexContext(req, resp);
                        
                        Object obj = ((TaggingserviceRequest)req).getObject();  // POSTデータの取得
                        
                        EntryBase retObj = null;
                        if (obj instanceof EntryBase) {
                                // Entry更新
                                retObj = reflexContext.putEntry((EntryBase)obj);
                        } else if (obj instanceof FeedBase) {
                                // Feed更新
                                retObj = reflexContext.putFeed((FeedBase)obj);
                        } else {
                                if (param.isAllocids()) {
                                        // put Allocids
                                        retObj = reflexContext.putAllocateIds(req.getPathInfo(), (String)obj);
                                }
                        }
                        
                        doResponse(resp, retObj, param.useJson, 
                                        TaggingserviceEnv.getDefault().getResourceMapper(), param.callback);

                } catch (Throwable e) {
                        // Filterに例外を返す
                        IOException ie = new IOException();
                        ie.initCause(e);
                        throw ie;
                }
        }

        public void doDelete(HttpServletRequest req, HttpServletResponse resp)
                        throws IOException {

                RequestType param = ((TaggingserviceRequest)req).getRequestType();
                try {
                        ReflexContext reflexContext = new ReflexContext(req, resp);
                        
                        EntryBase retObj = null;
                        String uri = req.getPathInfo();
                        if (param.isForce()) {
                                // Feed削除
                                retObj = reflexContext.deleteFeed(uri);
                        } else {
                                int revision = intValue(param.revision);
                                // Entry削除
                                retObj = reflexContext.deleteEntry(uri, revision);
                        }
                        
                        doResponse(resp, retObj, param.useJson, 
                                        TaggingserviceEnv.getDefault().getResourceMapper(), param.callback);

                } catch (Throwable e) {
                        // Filterに例外を返す
                        IOException ie = new IOException();
                        ie.initCause(e);
                        throw ie;
                }
        }

        private String getRequestUri(HttpServletRequest req) {
                StringBuffer buf = new StringBuffer();
                buf.append(req.getPathInfo());
                String queryString = req.getQueryString();
                if (queryString != null) {
                        buf.append(&quot;?&quot;);
                        buf.append(queryString);
                }
                return buf.toString();
        }
        
        private int intValue(String str) {
                if (str != null) {
                        try {
                                return Integer.parseInt(str);
                        } catch (NumberFormatException e) {}    // Do nothing.
                }
                return 0;
        }

}</pre>
</div>
<ul><li>BlankSimplyProviderではTaggingserviceFilterを使用しているため、 HttpServletRequestはTaggingserviceRequestに、 HttpServletResponseはTaggingserviceResponseに変換されています。</li>
<li>doGet<ul><li>RequestType param = ((TaggingserviceRequest)req).getRequestType() により、リクエストタイプ情報を得ます。</li>
<li>リクエストタイプ情報より、取得情報の判別を行います。<ul><li>?entryパラメータがセットされている場合、param.isEntry()がtrueになるので、エントリー情報を返します。</li>
<li>?allocidsパラメータがセットされている場合、paraam.isAllocids()がtrueになるので、採番処理の結果を返します。</li>
<li>?countパラメータがセットされている場合、param.isCount()がtrueになるので、件数を返します。</li>
<li>上記パラメータがセットされていない場合、指定されたキー配下のエントリーをFeedにまとめて返します。</li>
<li>doResponse(resp, retObj, param.useJson, TaggingserviceEnv.getDefault().getResourceMapper(), param.callback) により 結果をレスポンスに設定します。<ul><li>?xmlパラメータがセットされている場合、param.useJsonがtrueになるので、この値をdoResponseメソッドの引数にセットすることでXMLまたはJSONにシリアライズされます。</li>
<li>?callbackパラメータがセットされている場合、param.callbackにパラメータの値が設定されるので、この値をdoResponseメソッドの引数にセットすることでJSONP形式でシリアライズされます。(useJson=trueの場合のみ)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>doPost<ul><li>getObject()により、XMLやJSONの入力データをエンティティオブジェクトに変換します。</li>
<li>エンティティオブジェクトをパラメータに以下のメソッドを実行することで、BDBへの登録処理が実行されます。<ul><li>postEntry()もしくは、postFeed()<ul><li>入力データがEntryかFeedかで実行メソッドを区別します。</li>
</ul>
</li>
</ul>
</li>
<li>postEntry()もしくは、postFeed()メソッドの引数は、エンティティオブジェクトのみのものと、 リクエストのPathInfo(URLのサーブレットパス以降の情報)を指定するものと２通りあります。 それぞれの登録キーは以下の通りです。<ul><li>postXXX(obj)<ul><li>エントリーのlinkタグのrel属性が&quot;self&quot;のhref属性の値をキーにして登録します。</li>
</ul>
</li>
<li>postXXX(obj, uri)<ul><li>エントリーのlinkタグのrel属性が&quot;self&quot;がセットされている場合、href属性の値をキーにして登録します。</li>
<li>上記内容がセットされていない場合、uri引数の値を親フォルダとし、自動採番した値をキーにして登録します。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>doPut<ul><li>エンティティオブジェクトをパラメータに以下のメソッドを実行することで更新処理が実行されます。<ul><li>putEntry()もしくはputFeed()</li>
</ul>
</li>
<li>URLパラメータにallocidsがセットされている場合、採番の初期設定処理となります。</li>
</ul>
</li>
<li>doDelete<ul><li>以下のメソッドを実行することで削除処理が実行されます。<ul><li>deleteFeed()、もしくは、deleteEntry()</li>
<li>?forceオプションがあればdeleteFeed()が実行されます。 deleteFeed()では指定されたフォルダ配下のentryをすべて削除します。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="reflexbdb_tutorial_1.html">前へ &lt;&lt;</a> <a href="reflexbdb_tutorial_3.html"><b>&gt;&gt; 次へ</b></a></p>
</div>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2006-2012
    
          Virtual Technology
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
